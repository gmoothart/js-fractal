<!DOCTYPE html>
<html>
  <head>
  
  </head>
  <body>
    <canvas id="c" width=800 height="600" style="position:absolute; z-index:0" ></canvas>
    <canvas id="overlayCanvas" width=800 height="600" style="position:absolute; z-index:1" ></canvas>

      <script src="jquery-1.7.1.js"></script>
      <script src="mandelbrot.js"></script>
      <script>
          var overlay = $('#overlayCanvas'),
              ctx = overlay[0].getContext('2d'),
              isDragging = false,
              rectXStart, rectYStart;


          // draw selection rectangle
          overlay.on('mousedown', function(ev) {
              isDragging = true;

              rectXStart = ev.offsetX;
              rectYStart = ev.offsetY;
          });
          overlay.on('mouseup', function(ev) {
              isDragging = false;
          });
          overlay.on('mousemove', function(ev) {
              var x2 = ev.offsetX,
                  y2;

              // constrain selection to canvas aspect ration
              if (ev.offsetY > rectYStart) {
                y2 = rectYStart + 3*(Math.abs(rectXStart - ev.offsetX)) / 4;
              }
              else {
                y2 = rectYStart - 3*(Math.abs(rectXStart - ev.offsetX)) / 4;
              }
              if (isDragging) {
                  ctx.clearRect(0,0,800,600);
                  ctx.strokeStyle = '#6699ff';
                  ctx.beginPath();
                  ctx.moveTo(rectXStart, rectYStart);
                  ctx.lineTo(rectXStart, y2);
                  ctx.lineTo(x2, y2);
                  ctx.lineTo(x2, rectYStart);
                  ctx.lineTo(rectXStart, rectYStart);
                  ctx.stroke();
              }
          });




          Mandelbrot.draw( $('#c')[0] );
      </script>
  </body>
</html>
